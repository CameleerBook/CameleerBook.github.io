<!DOCTYPE html><html><head><title>List Stack</title><style>span {tab-size: 2;} .logical { color:rgb(244, 157, 55); } .keyword { color: red; } .contract { color: #1069B3; } .comment { color: #666666; } .number { color: black; }.info { border-top: 1px solid black; }.title { border-bottom: 1px solid black; }</style></head><body><div class="title"><h2>Stack (Using A List)<h2></div><pre>
<span class="comment">(* Implementation and specification by Pedro Gasparinho, advised by 
   MÃ¡rio Pereira *)</span>

<span class="keyword">module</span> <span class="keyword">type</span> Stack = <span class="keyword">sig</span>
  <span class="keyword">type</span> 'a stack
  <span class="contract">(*@ model view: 'a <span class="logical">list</span> *)</span>

  <span class="contract">(*@ <span class="logical">function</span> length (q: 'a stack) : <span class="logical">int</span> *)</span>

  <span class="keyword">exception</span> Empty

  <span class="keyword">val</span> empty : unit -> 'a stack
  <span class="contract">(*@ res = empty ()
      <span class="logical">ensures</span> length res = 0 *)</span>

  <span class="keyword">val</span> size : 'a stack -> <span class="keyword">int</span>
  <span class="contract">(*@ res = size q 
      <span class="logical">ensures</span> res = length q *)</span>

  <span class="keyword">val</span> is_empty : 'a stack -> <span class="keyword">bool</span>
  <span class="contract">(*@ res = is_empty q
      <span class="logical">ensures</span> res &lt;-> length q = 0 *)</span>

  <span class="keyword">val</span> push : 'a -> 'a stack -> 'a stack
  <span class="contract">(*@ res = push x q
      <span class="logical">ensures</span> length res = 1 + length q
      <span class="logical">ensures</span> res.view = Sequence.cons x q.view *)</span>

  <span class="keyword">val</span> head : 'a stack -> 'a
  <span class="contract">(*@ res = head q
      raises Empty -> length q = 0
      <span class="logical">ensures</span> res = q.view[0] *)</span>

  <span class="keyword">val</span> pop : 'a stack -> 'a * 'a stack
  <span class="contract">(*@ (v, res) = pop q
      raises Empty -> length q = 0
      <span class="logical">ensures</span> v = q.view[0]
      <span class="logical">ensures</span> res.view = q.view[1 ..] *)</span>
    
<span class="keyword">end</span>

<span class="keyword">module</span> ListStack : Stack = <span class="keyword">struct</span>
  
  <span class="keyword">type</span> 'a stack = {
    view: 'a <span class="keyword">list</span>
  }

  <span class="contract">(*@ <span class="logical">function</span> length (q: 'a stack) : <span class="logical">int</span> = <span class="logical">List</span>.length q.view *)</span>
  <span class="contract">(*@ <span class="logical">ensures</span> result >= 0 *)</span>

  <span class="keyword">exception</span> Empty

  <span class="keyword">let</span> empty () = { view = [] }
  <span class="contract">(*@ res = empty ()
      <span class="logical">ensures</span> length res = 0 *)</span>

  <span class="keyword">let</span> size q = <span class="keyword">List</span>.length q.view
  <span class="contract">(*@ res = size q 
      <span class="logical">ensures</span> res = length q *)</span>

  <span class="keyword">let</span> is_empty q = size q = 0
  <span class="contract">(*@ res = is_empty q
      <span class="logical">ensures</span> res &lt;-> length q = 0 *)</span>

  <span class="keyword">let</span> push x q = { view = x::q.view }
  <span class="contract">(*@ res = push x q
      <span class="logical">ensures</span> length res = 1 + length q
      <span class="logical">ensures</span> res.view = Sequence.cons x q.view *)</span>

  <span class="keyword">let</span> head q = 
    <span class="keyword">match</span> q.view <span class="keyword">with</span>
    | [] -> raise Empty
    | h::_ -> h
  <span class="contract">(*@ res = head q
      raises Empty -> length q = 0
      <span class="logical">ensures</span> res = q.view[0] *)</span>

  <span class="keyword">let</span> pop q = 
    <span class="keyword">match</span> q.view <span class="keyword">with</span>
    | [] -> raise Empty
    | h::t -> (h, { view = t })
  <span class="contract">(*@ (v, res) = pop q
      raises Empty -> length q = 0
      <span class="logical">ensures</span> v = q.view[0]
      <span class="logical">ensures</span> res.view = q.view[1 ..] *)</span>


<span class="keyword">end</span></pre>
<div class="info">
<p>This page was generated with <a href="https://github.com/PedroGasparinho/Cameleer2Html">Cameleer2Html</a><p>
</div>
</body></html>
